scheduler:
  name: scheduler
  key: "training/stage_0/scheduler"
  values:

    # Cosine annealing
    - type: cosine
      T_max: 300
      eta_min: 1.0e-6
    - type: cosine
      T_max: 300
      eta_min: 1.0e-7
    - type: cosine
      T_max: 300
      eta_min: 1.0e-8

    # Cosine annealing with warm restarts
    - type: cosine_warm_restarts
      T_0: 16
      T_mult: 2
      eta_min: 1.0e-7
    - type: cosine_warm_restarts
      T_0: 50
      T_mult: 1
      eta_min: 1.0e-7

    # Cyclic
    - type: cyclic
      base_lr: 1.0e-7
      max_lr: 1.0e-4
      step_size_up: 5_000
      mode: triangular2
      cycle_momentum: false
    - type: cyclic
      base_lr: 1.0e-7
      max_lr: 1.0e-4
      step_size_up: 10_000
      mode: triangular2
      cycle_momentum: false
    - type: cyclic
      base_lr: 1.0e-7
      max_lr: 1.0e-4
      step_size_up: 50_000
      mode: triangular2
      cycle_momentum: false

    # Reduce on plateau
    - type: reduce_on_plateau
      patience: 10
      factor: 0.707
      min_lr: 1.0e-7
    - type: reduce_on_plateau
      patience: 20
      factor: 0.707
      min_lr: 1.0e-7
    - type: reduce_on_plateau
      patience: 50
      factor: 0.707
      min_lr: 1.0e-7
    - type: reduce_on_plateau
      patience: 10
      factor: 0.5
      min_lr: 1.0e-7
    - type: reduce_on_plateau
      patience: 20
      factor: 0.5
      min_lr: 1.0e-7
    - type: reduce_on_plateau
      patience: 50
      factor: 0.5
      min_lr: 1.0e-7
    - type: reduce_on_plateau
      patience: 10
      factor: 0.1
      min_lr: 1.0e-7
    - type: reduce_on_plateau
      patience: 20
      factor: 0.1
      min_lr: 1.0e-7
    - type: reduce_on_plateau
      patience: 50
      factor: 0.1
      min_lr: 1.0e-7

    # OneCycle
    - type: onecycle
      epochs: 300
      steps_per_epoch: 957
      pct_start: 0.1
      max_lr: 1.0e-4
    - type: onecycle
      epochs: 300
      steps_per_epoch: 957
      pct_start: 0.2
      max_lr: 1.0e-4
    - type: onecycle
      epochs: 300
      steps_per_epoch: 957
      pct_start: 0.3
      max_lr: 1.0e-4